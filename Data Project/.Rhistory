paste(dollar(..x..), "total revenue"),
fill)),
col = "grey40",
bins = 24) +
scale_x_continuous("Total Revenue",
labels = dollar,
n.breaks = 5) +
scale_y_continuous("Number of Charities",
labels = comma) +
facet_wrap(Year ~ activity_group,
scales = "free_y") +
scale_fill_manual("",
values = c(FSSIQualSingle(2), FSSIGreenSingle)) +
theme_minimal() +
theme(panel.spacing.y = unit(3, "cm"))
pl_TotalRev_hist <- ggplotly(gg_TotalRev_hist,
tooltip = "text")
gg_TotalRev_loghist <- ggplot(VCOSS_TotalRev_1617) +
geom_histogram(aes(x = total_revenue,
fill = activity_group,
text = paste(sep = "\n",
paste(comma(..count..), "charities"),
paste(dollar(..x..^10), "total revenue"),
fill)),
col = "grey40",
bins = 24) +
scale_x_log10("Total Revenue",
labels = dollar_format(accuracy = 1,
scale = 0.000001,
suffix = "m"),
n.breaks = 5) +
scale_y_continuous("Number of Charities",
labels = comma) +
facet_wrap(Year ~ activity_group ,
scales = "free_y") +
scale_fill_manual("",
values = c(FSSIQualSingle(2), FSSIGreenSingle)) +
theme_minimal() +
theme(panel.spacing.y = unit(3, "cm"))
VCOSS_TotalRev_1617 <- transmute(VCOSS_ACNC_16,
main_activity = main_activity_2016,
total_revenue = total_revenue_2016,
Year = 2016)
VCOSS_TotalRev_1617 <- rbind(VCOSS_TotalRev_1617,
transmute(VCOSS_ACNC_17,
main_activity = main_activity,
total_revenue = total_revenue_2017,
Year = 2017))
VCOSS_TotalRev_1617 <- mutate(VCOSS_TotalRev_1617,
activity_group = if_else(str_detect(main_activity,
regex("social services",
ignore_case = TRUE)),
true = "Social Services",
false = "Other Sectors"))
gg_TotalRev_hist <- ggplot(filter(VCOSS_TotalRev_1617,
total_revenue > 0)) +
geom_histogram(aes(x = total_revenue,
fill = activity_group,
text = paste(sep = "\n",
paste(comma(..count..), "charities"),
paste(dollar(..x..), "total revenue"),
fill)),
col = "grey40",
bins = 24) +
scale_x_continuous("Total Revenue",
labels = dollar,
n.breaks = 5) +
scale_y_continuous("Number of Charities",
labels = comma) +
facet_wrap(Year ~ activity_group,
scales = "free_y") +
scale_fill_manual("",
values = c(FSSIQualSingle(2), FSSIGreenSingle)) +
theme_minimal() +
theme(panel.spacing.y = unit(3, "cm"))
pl_TotalRev_hist <- ggplotly(gg_TotalRev_hist,
tooltip = "text")
gg_TotalRev_loghist <- ggplot(VCOSS_TotalRev_1617) +
geom_histogram(aes(x = total_revenue,
fill = activity_group,
text = paste(sep = "\n",
paste(comma(..count..), "charities"),
paste(dollar(..x..^10), "total revenue"),
fill)),
col = "grey40",
bins = 24) +
scale_x_log10("Total Revenue",
labels = dollar_format(accuracy = 1,
scale = 0.000001,
suffix = "m"),
n.breaks = 5) +
scale_y_continuous("Number of Charities",
labels = comma) +
facet_wrap(Year ~ activity_group ,
scales = "free_y") +
scale_fill_manual("",
values = c(FSSIQualSingle(2), FSSIGreenSingle)) +
theme_minimal() +
theme(panel.spacing.y = unit(3, "cm"))
pl_TotalRev_loghist <- ggplotly(gg_TotalRev_loghist,
tooltip = "text")
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.1, 0.1)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue\n(standard scale)",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue\n(standard scale)",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue\n(logarithmic scale)",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue\n(logarithmic scale)",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
VCOSS_TotalRev_1617 <- transmute(VCOSS_ACNC_16,
main_activity = main_activity_2016,
total_revenue = total_revenue_2016,
Year = 2016)
VCOSS_TotalRev_1617 <- rbind(VCOSS_TotalRev_1617,
transmute(VCOSS_ACNC_17,
main_activity = main_activity,
total_revenue = total_revenue_2017,
Year = 2017))
VCOSS_TotalRev_1617 <- mutate(VCOSS_TotalRev_1617,
activity_group = if_else(str_detect(main_activity,
regex("social services",
ignore_case = TRUE)),
true = "Social Services",
false = "Other Sectors"))
gg_TotalRev_hist <- ggplot(filter(VCOSS_TotalRev_1617,
total_revenue > 0)) +
geom_histogram(aes(x = total_revenue,
fill = activity_group,
text = paste(sep = "\n",
paste(comma(..count..), "charities"),
paste(dollar(..x..), "total revenue"),
fill)),
col = "grey40",
bins = 24) +
scale_x_continuous("Total Revenue",
labels = dollar_format(accuracy = 1,
scale = 0.000001,
suffix = "m"),
n.breaks = 5) +
scale_y_continuous("Number of Charities",
labels = comma) +
facet_wrap(Year ~ activity_group,
scales = "free_y") +
scale_fill_manual("",
values = c(FSSIQualSingle(2), FSSIGreenSingle)) +
theme_minimal() +
theme(panel.spacing.y = unit(3, "cm"))
pl_TotalRev_hist <- ggplotly(gg_TotalRev_hist,
tooltip = "text")
gg_TotalRev_loghist <- ggplot(VCOSS_TotalRev_1617) +
geom_histogram(aes(x = total_revenue,
fill = activity_group,
text = paste(sep = "\n",
paste(comma(..count..), "charities"),
paste(dollar(..x..^10), "total revenue"),
fill)),
col = "grey40",
bins = 24) +
scale_x_log10("Total Revenue",
labels = dollar,
n.breaks = 5) +
scale_y_continuous("Number of Charities",
labels = comma) +
facet_wrap(Year ~ activity_group ,
scales = "free_y") +
scale_fill_manual("",
values = c(FSSIQualSingle(2), FSSIGreenSingle)) +
theme_minimal() +
theme(panel.spacing.y = unit(3, "cm"))
pl_TotalRev_loghist <- ggplotly(gg_TotalRev_loghist,
tooltip = "text")
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.1, 0.1)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue\n(standard scale)",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue\n(standard scale)",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue\n(logarithmic scale)",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue\n(logarithmic scale)",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.1, 0.1)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities\quad\quad",
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities \\quad\\quad",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities                 ",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities                 ",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities&emsp",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis3 = list(title = list(text = "Number of Charities",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis = list(title = list(text = "Number of Charities",
standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
# yaxis = list(title = list(text = "Number of Charities",
#                           standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 2)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
# yaxis = list(title = list(text = "Number of Charities",
#                           standoff = 2)),
yaxis5 = list(title = list(text = "Number of Charities",
standoff = 20)))
subplot(pl_TotalRev_hist, pl_TotalRev_loghist,
nrows = 2,
margin = c(0, 0,
0.066, 0.066)) %>%
layout(title = list(text = "Distribution of Total Revenue on Standard and Logarithmic Scales",
standoff = 20,
xref = "canvas",
x = 0.1),
legend = list(title = list(text = "Main Activity",
standoff = 10,
font = list(size = 14)),
itemclick = "toggleothers",
itemdoubleclick = "toggle"),
margin = list(t = 80, b = 10,
l = 5, r = 5),
font = list(family = FSSIfont,
size = 12),
xaxis = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis2 = list(title = list(text = "Total Revenue - standard scale",
standoff = 0)),
xaxis3 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
xaxis4 = list(title = list(text = "Total Revenue - logarithmic scale",
standoff = 1)),
yaxis = list(title = list(text = "Number of\nCharities",
standoff = 5)),
yaxis3 = list(title = list(text = "Number of\nCharities",
standoff = 5)),
yaxis5 = list(title = list(text = "Number of\nCharities",
standoff = 5)),
yaxis7 = list(title = list(text = "Number of\nCharities",
standoff = 5)))
